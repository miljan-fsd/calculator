$(document).ready(function(){var display=$(".display"),history=$(".history");function clearAll(){display.html("O"),history.html("")}function clearEntry(){display.text(display.text().slice(0,-1)),history.text(history.text().slice(0,-1)),$(".display").text().length<1&&clearAll()}function roundResult(t){return parseFloat(Number(t).toPrecision(10))}function calculate(action){if(display.text().match(/([\d])+[\)]?$/)){var result,expression=display.text().replace(/action/,"");"="===action?(result=eval(expression),result=roundResult(result),history.append("="+result)):"pow"===action?(result=Math.pow(expression,2),result=roundResult(result),history.text(result)):"sqrt"===action?-1===Math.sign(expression)?display.text("Error"):(result=Math.sqrt(expression),result=roundResult(result),history.text(result)):"sign"===action?(Math.sign(expression),expression*=-1,result=roundResult(expression),history.text(result)):"%"===action&&(result=expression/100,result=roundResult(result),history.text(result)),display.text(result)}else display.text("Error")}$(".btn").click(function(){var t=$(this).val();if("O"===display.text()&&(display.text(""),history.text("")),display.text().length<=1&&""===history.text()&&("+"===t||")"===t||"*"===t||"/"===t))clearAll();else{if(display.text().match(/[\+\-\*\/\.]$/)&&("+"===t||"-"===t||"*"===t||"/"===t||"."===t))return null;if((display.text().match(/\d+[\.]\d+$/)||display.text().match(/[\.]\d+$/))&&"."===t)return null;"ce"===t?clearEntry():"ac"===t?clearAll():"="===t?calculate("="):"sqrt"===t?calculate("sqrt"):"sign"===t?calculate("sign"):"%"===t?calculate("%"):"pow"===t?calculate("pow"):(display.append(t),history.append(t))}})});