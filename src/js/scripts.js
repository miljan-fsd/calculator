$(document).ready(function(){var display=$(".display"),history=$(".history");function clearAll(){display.html("O"),history.html("")}function clearEntry(){display.text(display.text().slice(0,-1)),history.text(history.text().slice(0,-1)),$(".display").text().length<1&&clearAll()}function roundResult(t){return parseFloat(Number(t).toPrecision(10))}function calculate(action){var result,expression=display.text().replace(/action/,"");if("="===action){try{result=eval(expression)}catch(t){return display.text("Error")}result=roundResult(result),history.append("="+result)}else if("pow"===action){if(result=Math.pow(expression,2),isNaN(result))return display.text("Error");result=roundResult(result),history.text(result)}else if("sqrt"===action){if(result=Math.sqrt(expression),isNaN(result))return display.text("Error");result=roundResult(result),history.text(result)}else if("sign"===action){if(result=(Math.sign(expression),expression*=-1),isNaN(result))return display.text("Error");result=roundResult(result),history.text(result)}else if("%"===action){if(result=expression/100,isNaN(result))return display.text("Error");result=roundResult(result),history.text(result)}display.text(result)}$(".btn").click(function(){var t=$(this).val();if(display.text().match(/[^\d\-\+\*\/\.\)\(]/)&&clearAll(),"O"===display.text()&&(display.text(""),history.text("")),display.text().length<=1&&""===history.text()&&("+"===t||")"===t||"*"===t||"/"===t))clearAll();else{if(display.text().match(/[\+\-\*\/\.]$/)&&("+"===t||"-"===t||"*"===t||"/"===t||"."===t))return null;if((display.text().match(/\d+[\.]\d+$/)||display.text().match(/[\.]\d+$/))&&"."===t)return null;"ce"===t?clearEntry():"ac"===t?clearAll():"="===t?calculate("="):"sqrt"===t?calculate("sqrt"):"sign"===t?calculate("sign"):"%"===t?calculate("%"):"pow"===t?calculate("pow"):(display.append(t),history.append(t))}})});